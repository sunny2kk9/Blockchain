{"ast":null,"code":"import { ethers } from 'ethers';\nimport contractInfo from '../contractInfo.json';\n\n// Contract ABI - Application Binary Interface\nconst CONTRACT_ABI = [\"function getValue() public view returns (uint256)\", \"function setValue(uint256 _value) public\", \"event ValueChanged(uint256 oldValue, uint256 newValue)\"];\nlet contract = null;\nlet provider = null;\nlet signer = null;\n\n// Initialize provider and contract\nexport const initContract = async () => {\n  if (typeof window.ethereum !== 'undefined') {\n    provider = new ethers.BrowserProvider(window.ethereum);\n    signer = await provider.getSigner();\n    contract = new ethers.Contract(contractInfo.address, CONTRACT_ABI, signer);\n    return contract;\n  } else {\n    throw new Error('MetaMask is not installed. Please install MetaMask to use this app.');\n  }\n};\n\n// Connect wallet\nexport const connectWallet = async () => {\n  if (typeof window.ethereum !== 'undefined') {\n    try {\n      // Request account access\n      const accounts = await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n\n      // Initialize contract after connecting\n      await initContract();\n      return accounts[0];\n    } catch (error) {\n      throw new Error('User rejected the connection request');\n    }\n  } else {\n    throw new Error('MetaMask is not installed. Please install MetaMask extension.');\n  }\n};\n\n// Get contract instance\nexport const getContract = async () => {\n  if (!contract) {\n    await initContract();\n  }\n  return contract;\n};\n\n// Get current value from contract\nexport const getCurrentValue = async () => {\n  try {\n    const contractInstance = await getContract();\n    const value = await contractInstance.getValue();\n    return value.toString();\n  } catch (error) {\n    throw new Error(`Failed to get value: ${error.message}`);\n  }\n};\n\n// Set new value in contract\nexport const setValue = async value => {\n  try {\n    const contractInstance = await getContract();\n    const tx = await contractInstance.setValue(value);\n    return tx;\n  } catch (error) {\n    var _error$message, _error$message2;\n    // Check for user rejection in various error formats\n    if (error.code === 4001 || error.code === 'ACTION_REJECTED' || (_error$message = error.message) !== null && _error$message !== void 0 && _error$message.includes('user rejected') || (_error$message2 = error.message) !== null && _error$message2 !== void 0 && _error$message2.includes('User denied') || error.reason === 'rejected') {\n      throw new Error('Transaction cancelled. You rejected the transaction in MetaMask.');\n    }\n    throw new Error(`Failed to set value: ${error.message}`);\n  }\n};","map":{"version":3,"names":["ethers","contractInfo","CONTRACT_ABI","contract","provider","signer","initContract","window","ethereum","BrowserProvider","getSigner","Contract","address","Error","connectWallet","accounts","request","method","error","getContract","getCurrentValue","contractInstance","value","getValue","toString","message","setValue","tx","_error$message","_error$message2","code","includes","reason"],"sources":["/Users/moriro/Codes/Assignment 2/frontend/src/utils/web3.js"],"sourcesContent":["import { ethers } from 'ethers';\nimport contractInfo from '../contractInfo.json';\n\n// Contract ABI - Application Binary Interface\nconst CONTRACT_ABI = [\n  \"function getValue() public view returns (uint256)\",\n  \"function setValue(uint256 _value) public\",\n  \"event ValueChanged(uint256 oldValue, uint256 newValue)\"\n];\n\nlet contract = null;\nlet provider = null;\nlet signer = null;\n\n// Initialize provider and contract\nexport const initContract = async () => {\n  if (typeof window.ethereum !== 'undefined') {\n    provider = new ethers.BrowserProvider(window.ethereum);\n    signer = await provider.getSigner();\n    contract = new ethers.Contract(contractInfo.address, CONTRACT_ABI, signer);\n    return contract;\n  } else {\n    throw new Error('MetaMask is not installed. Please install MetaMask to use this app.');\n  }\n};\n\n// Connect wallet\nexport const connectWallet = async () => {\n  if (typeof window.ethereum !== 'undefined') {\n    try {\n      // Request account access\n      const accounts = await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n      \n      // Initialize contract after connecting\n      await initContract();\n      \n      return accounts[0];\n    } catch (error) {\n      throw new Error('User rejected the connection request');\n    }\n  } else {\n    throw new Error('MetaMask is not installed. Please install MetaMask extension.');\n  }\n};\n\n// Get contract instance\nexport const getContract = async () => {\n  if (!contract) {\n    await initContract();\n  }\n  return contract;\n};\n\n// Get current value from contract\nexport const getCurrentValue = async () => {\n  try {\n    const contractInstance = await getContract();\n    const value = await contractInstance.getValue();\n    return value.toString();\n  } catch (error) {\n    throw new Error(`Failed to get value: ${error.message}`);\n  }\n};\n\n// Set new value in contract\nexport const setValue = async (value) => {\n  try {\n    const contractInstance = await getContract();\n    const tx = await contractInstance.setValue(value);\n    return tx;\n  } catch (error) {\n    // Check for user rejection in various error formats\n    if (error.code === 4001 || \n        error.code === 'ACTION_REJECTED' ||\n        error.message?.includes('user rejected') ||\n        error.message?.includes('User denied') ||\n        error.reason === 'rejected') {\n      throw new Error('Transaction cancelled. You rejected the transaction in MetaMask.');\n    }\n    throw new Error(`Failed to set value: ${error.message}`);\n  }\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}